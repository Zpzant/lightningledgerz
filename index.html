<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lightning Ledgerz - Budget. Save. Build.</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: #000;
            color: #fff;
            overflow-x: hidden;
        }

        .video-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -2;
            overflow: hidden;
        }

        .video-background iframe {
            position: absolute;
            top: 50%;
            left: 50%;
            min-width: 100vw;
            min-height: 100vh;
            width: auto;
            height: auto;
            transform: translate(-50%, -50%);
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }

        .video-background iframe.active {
            opacity: 1;
        }

        .lightning-flash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #ff3333;
            z-index: -1;
            opacity: 0;
            pointer-events: none;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.4);
            z-index: -1;
        }

        nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .nav-links a {
            color: #fff;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
            cursor: pointer;
        }

        .nav-links a:hover {
            color: #ff3333;
        }

        .hero {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 120px 2rem 0 2rem;
            position: relative;
            z-index: 1;
        }

        .hero h1 {
            font-size: 4rem;
            font-weight: bold;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }

        .hero p {
            font-size: 1.5rem;
            margin-bottom: 2rem;
            color: #ccc;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        }

        .cta-button {
            background: linear-gradient(45deg, #ff3333, #ff6666);
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            box-shadow: 0 4px 15px rgba(255, 51, 51, 0.4);
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 51, 51, 0.6);
            background: linear-gradient(45deg, #ff1a1a, #ff4d4d);
        }

        .package-sidebar {
            position: fixed;
            left: 20px;
            bottom: 20px;
            z-index: 999;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .package-btn {
            padding: 1rem 1.5rem;
            border: 2px solid #fff;
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            backdrop-filter: blur(10px);
        }

        .package-btn:hover {
            transform: translateX(10px);
        }

        .package-btn.basic:hover {
            background: #ff3333;
            border-color: #ff3333;
            box-shadow: 0 0 20px #ff3333;
        }

        .package-btn.gold:hover {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #000;
            border-color: #ffd700;
            box-shadow: 0 0 20px #ffd700;
        }

        .package-btn.diamond:hover {
            background: linear-gradient(45deg, #fff, #e0e0e0);
            color: #000;
            border-color: #fff;
            box-shadow: 0 0 20px #fff;
        }

        .section {
            min-height: 100vh;
            padding: 6rem 2rem 2rem;
            background: rgba(0, 0, 0, 0.9);
            margin-top: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .section h2 {
            font-size: 3rem;
            margin-bottom: 2rem;
            text-align: center;
            color: #ff3333;
        }

        .package-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .package-card {
            background: linear-gradient(135deg, rgba(255, 51, 51, 0.1), rgba(0, 0, 0, 0.8));
            border: 2px solid #ff3333;
            border-radius: 20px;
            padding: 2.5rem;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .package-card:hover {
            transform: translateY(-15px) scale(1.02);
            box-shadow: 0 20px 40px rgba(255, 51, 51, 0.4);
        }

        .package-card h3 {
            color: #ff3333;
            margin-bottom: 1rem;
            font-size: 1.8rem;
            font-weight: bold;
        }

        #gold-package h3 {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: bold;
        }

        #gold-package:hover {
            border-color: #ffd700;
            box-shadow: 0 0 20px #ffd700;
        }

        .package-price {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 1.5rem;
            padding: 0.5rem;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 10px;
        }

        .package-features {
            list-style: none;
            padding: 0;
            margin: 1.5rem 0;
            text-align: left;
        }

        .package-features li {
            margin-bottom: 0.8rem;
            padding-left: 1rem;
            position: relative;
            font-size: 1rem;
            line-height: 1.4;
        }

        .package-features li:before {
            content: "âš¡";
            position: absolute;
            left: -0.5rem;
            color: #ff3333;
            font-weight: bold;
        }

        .btn {
            display: inline-block;
            padding: 1rem 2rem;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }

        .btn-primary {
            background: linear-gradient(45deg, #ff3333, #ff6666);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 51, 51, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 51, 51, 0.6);
            background: linear-gradient(45deg, #ff1a1a, #ff4d4d);
        }

        .about-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 3rem;
            align-items: center;
            margin-top: 3rem;
        }

        .about-photo {
            background: transparent;
            text-align: center;
            padding: 0;
            border: 3px solid #ff3333;
            border-radius: 15px;
            overflow: hidden;
            max-width: 400px;
            margin: 0 auto;
        }

        .about-photo img {
            width: 100%;
            height: auto;
            border-radius: 15px;
            display: block;
            object-fit: contain;
        }

        .about-text {
            font-size: 1.1rem;
            line-height: 1.8;
        }

        .contact-form {
            max-width: 600px;
            margin: 3rem auto;
            background: rgba(255, 51, 51, 0.1);
            padding: 2rem;
            border-radius: 15px;
            border: 1px solid #ff3333;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #ff3333;
            font-weight: bold;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 1rem;
            border: 1px solid #333;
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            border-radius: 8px;
            font-size: 1rem;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #ff3333;
            box-shadow: 0 0 10px rgba(255, 51, 51, 0.3);
        }

        .profile-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .profile-card {
            background: linear-gradient(135deg, rgba(255, 51, 51, 0.1), rgba(0, 0, 0, 0.8));
            border: 1px solid #ff3333;
            border-radius: 15px;
            padding: 2rem;
        }

        .profile-card h3 {
            color: #ff3333;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }

        .profile-info p {
            margin-bottom: 0.8rem;
            font-size: 1.1rem;
        }

        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-toggle {
            color: #fff;
            cursor: pointer;
            font-weight: 500;
            padding: 0.5rem;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .dropdown-toggle:hover {
            color: #ff3333;
        }

        .dropdown-menu {
            display: none;
            position: absolute;
            top: 120%;
            left: 0;
            background-color: rgba(0, 0, 0, 0.95);
            min-width: 150px;
            z-index: 999;
            border: 1px solid #ff3333;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(255, 51, 51, 0.3);
        }

        .dropdown-menu a {
            color: #fff;
            padding: 0.8rem 1rem;
            display: block;
            text-decoration: none;
            transition: background 0.3s ease;
        }

        .dropdown-menu a:hover {
            background-color: #ff3333;
            color: #000;
        }

        .dropdown:hover .dropdown-menu {
            display: block;
        }

        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .auth-box {
            background: #111;
            padding: 2rem;
            border-radius: 1rem;
            border: 2px solid #ff3333;
            text-align: center;
            max-width: 400px;
            width: 90%;
        }

        .auth-box h2 {
            color: #ff3333;
            margin-bottom: 1.5rem;
        }

        .auth-box input {
            display: block;
            width: 100%;
            padding: 0.75rem;
            margin: 1rem 0;
            border: 1px solid #333;
            border-radius: 0.5rem;
            background: #222;
            color: #fff;
            font-size: 1rem;
        }

        .auth-box button {
            background: linear-gradient(45deg, #ff3333, #ff6666);
            border: none;
            padding: 0.75rem 2rem;
            color: #fff;
            font-weight: bold;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 1rem;
            width: 100%;
            margin-top: 0.5rem;
            transition: all 0.3s ease;
        }

        .auth-box button:hover {
            background: linear-gradient(45deg, #ff1a1a, #ff4d4d);
            transform: translateY(-2px);
        }

        .auth-box .text-link {
            color: #ff6666;
            text-decoration: underline;
            cursor: pointer;
            font-size: 0.9rem;
            margin-top: 1rem;
            display: inline-block;
        }

        .hidden {
            display: none;
        }

        .upload-area {
            background: rgba(0, 0, 0, 0.3);
            padding: 1.5rem;
            border-radius: 10px;
            border: 2px dashed #ff3333;
        }

        .upload-area input[type="file"] {
            width: 100%;
            padding: 0.5rem;
            margin-bottom: 1rem;
            color: #fff;
        }

        .document-item {
            background: rgba(0, 0, 0, 0.5);
            padding: 1rem;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .document-item strong {
            color: #ff3333;
        }

        .document-item p {
            font-size: 0.9rem;
            color: #888;
            margin-top: 0.3rem;
        }

        .document-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .about-content {
                grid-template-columns: 1fr;
            }
            .profile-content {
                grid-template-columns: 1fr;
            }
            .hero h1 {
                font-size: 2.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="video-background" id="videoBackground">
        <iframe src="https://streamable.com/e/0ek0up?autoplay=1&nocontrols=1" frameborder="0" allowfullscreen class="active"></iframe>
    </div>

    <div class="lightning-flash" id="lightningFlash"></div>
    <div class="overlay"></div>

    <nav>
        <a href="#top" class="logo">
            <img src="LightningLedgerzLogo.png" alt="Lightning Ledgerz Logo" style="height: 55px;">
        </a>
        <div class="nav-links">
            <a href="#services">Services</a>
            <a href="#about">About</a>
            <a href="#contact">Contact</a>
            <div class="dropdown">
                <a class="dropdown-toggle">Get Started</a>
                <div class="dropdown-menu">
                    <a href="#signup" onclick="showSignUp(event)">Sign Up</a>
                    <a href="#signin" onclick="showSignIn(event)">Sign In</a>
                    <a href="#profile" onclick="handleMyProfileClick(event)">My Profile</a>
                </div>
            </div>
        </div>
    </nav>

    <section class="hero">
        <img src="LightningLedgerzLogo.png" alt="Lightning Ledgerz Logo" style="max-width: 350px; width: 80%; height: auto;">
        <p style="max-width: 800px; margin: 1rem auto;">
            From supercharged budgets to strategy â€” we deliver results at lightning speed.
        </p>
        <a href="#contact" class="cta-button">Contact Us</a>
    </section>

    <div class="package-sidebar">
        <div class="package-btn basic" onclick="scrollToPackage('basic-package')">âš¡ Basic Package</div>
        <div class="package-btn gold" onclick="scrollToPackage('gold-package')">âœ¨ Gold Package</div>
        <div class="package-btn diamond" onclick="scrollToPackage('diamond-package')">ðŸ’Ž Diamond Package</div>
    </div>

    <section id="services" class="section">
        <div class="container">
            <h2>Our Service Packages</h2>
            <div class="package-grid">
                <div id="basic-package" class="package-card basic">
                    <h3>âš¡ Basic Package</h3>
                    <div class="package-price">Starting at $799</div>
                    <ul class="package-features">
                        <li>One-time comprehensive budget creation</li>
                        <li>Monthly financial reporting</li>
                        <li>Basic financial analysis</li>
                        <li>Email support</li>
                        <li>Budget optimization recommendations</li>
                    </ul>
                    <a href="tel:+13303015742" class="btn btn-primary">Call for Pricing</a><br><br>
                    <a href="https://buy.stripe.com/dRmfZheTUbkcgT7fuNbsc02" target="_blank" class="btn btn-primary">Buy Now</a>
                </div>

                <div id="gold-package" class="package-card gold">
                    <h3>âœ¨ Gold Package</h3>
                    <div class="package-price">Call for Custom Quote</div>
                    <ul class="package-features">
                        <li>Everything in Basic Package</li>
                        <li>Weekly strategic calls</li>
                        <li>Advanced financial modeling</li>
                        <li>Cash flow optimization</li>
                        <li>KPI dashboard creation</li>
                        <li>Priority support</li>
                    </ul>
                    <a href="tel:+13303015742" class="btn btn-primary">Call for Pricing</a><br><br>
                    <a href="https://buy.stripe.com/28E28r1348805apeqJbsc01" target="_blank" class="btn btn-primary">Buy Now</a>
                </div>

                <div id="diamond-package" class="package-card diamond">
                    <h3>ðŸ’Ž Diamond Package</h3>
                    <div class="package-price">Call for Custom Quote</div>
                    <ul class="package-features">
                        <li>Full-time fractional CFO services</li>
                        <li>Complete strategic planning</li>
                        <li>Investment & funding guidance</li>
                        <li>Board meeting preparation</li>
                        <li>M&A transaction support</li>
                        <li>Direct phone access</li>
                        <li>Custom financial systems</li>
                    </ul>
                    <a href="tel:+13303015742" class="btn btn-primary">Call for Pricing</a><br><br>
                    <a href="https://buy.stripe.com/dRm9ATbHIdsk5ap0zTbsc00" target="_blank" class="btn btn-primary">Buy Now</a>
                </div>
            </div>
        </div>
    </section>

    <section id="about" class="section">
        <div class="container">
            <h2>About Our Founder</h2>
            <div class="about-content">
                <div class="about-photo">
                    <img src="zac_mps.jpg" alt="Zac Prizant Headshot">
                </div>
                <div class="about-text">
                    <p>Zac Prizant is a Cornell University and Cornell SC Johnson School Graduate School of Management alumnus, and elite endurance athlete who ran 3,000 miles across the country with his twin brother from San Francisco to NYC. After closing $500M+ in investment banking and private equity deals, Zac managed a portfolio of 60+ hotels, transforming an antiquated eight-hour-per-budget procedure into a seven-minute one.</p>
                    <p>He went on to serve as a fractional CFO for businesses in various industries ranging from logistics, to law, entertainment, and tech. He launched Lightning Ledgerz to bring elite budgeting and strategy to the masses.</p>
                    <p>He now trains jiu jitsu in Las Vegas and coaches clients with the intensity of a champion and the heart of a brother.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="contact" class="section">
        <div class="container">
            <h2>Get In Touch</h2>
            <form action="https://formspree.io/f/manjdppp" method="POST" class="contact-form">
                <div class="form-group">
                    <label for="name">Name</label>
                    <input type="text" id="name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="phone">Phone</label>
                    <input type="tel" id="phone" name="phone">
                </div>
                <div class="form-group">
                    <label for="message">Message</label>
                    <textarea id="message" name="message" rows="5" required></textarea>
                </div>
                <button type="submit" class="cta-button">Send Message</button>
            </form>
        </div>
    </section>

    <section id="profile" class="section" style="display: none;">
        <div class="container">
            <h2>My Profile</h2>
            <div id="welcomeMessage" style="text-align: center; font-size: 1.5rem; margin-bottom: 2rem; color: #ff3333;"></div>
            
            <div class="profile-content">
                <div class="profile-card">
                    <h3>Account Information</h3>
                    <div class="profile-info">
                        <p><strong>Email:</strong> <span id="userEmail">Loading...</span></p>
                        <p><strong>Plan:</strong> <span id="userPlan">No package selected</span></p>
                        <p><strong>Status:</strong> <span style="color: #4CAF50;">Active</span></p>
                    </div>
                    <button class="btn btn-primary" onclick="signOutUser()" style="margin-top: 1rem;">Sign Out</button>
                </div>

                <div class="profile-card">
                    <h3>Upload Documents</h3>
                    <div class="upload-area">
                        <input type="file" id="fileUpload" accept=".pdf,.xlsx,.xls,.csv" multiple>
                        <button class="btn btn-primary" onclick="uploadDocuments()">Upload Files</button>
                        <div id="uploadProgress" style="margin-top: 1rem; display: none;">
                            <div style="background: #333; height: 20px; border-radius: 10px; overflow: hidden;">
                                <div id="uploadBar" style="background: #ff3333; height: 100%; width: 0%; transition: width 0.3s;"></div>
                            </div>
                            <p id="uploadStatus" style="text-align: center; margin-top: 0.5rem; font-size: 0.9rem;"></p>
                        </div>
                    </div>
                    
                    <h4 style="margin-top: 2rem; color: #ff3333;">Your Documents</h4>
                    <div id="documentsList" style="margin-top: 1rem;">
                        <p style="color: #888;">Loading documents...</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div id="signup-modal" class="auth-modal hidden">
        <div class="auth-box">
            <h2>Sign Up</h2>
            <form id="signup-form">
                <input type="text" id="signup-firstname" placeholder="First Name" required />
                <input type="text" id="signup-lastname" placeholder="Last Name" required />
                <input type="email" id="signup-email" placeholder="Email" required />
                <input type="password" id="signup-password" placeholder="Password (min 6 characters)" required />
                <button type="submit">Create Account</button>
            </form>
            <a class="text-link" onclick="switchToSignIn()">Already have an account? Sign in</a>
        </div>
    </div>

    <div id="signin-modal" class="auth-modal hidden">
        <div class="auth-box">
            <h2>Sign In</h2>
            <form id="signin-form">
                <input type="email" id="signin-email" placeholder="Email" required />
                <input type="password" id="signin-password" placeholder="Password" required />
                <button type="submit">Log In</button>
            </form>
            <a class="text-link" id="forgot-password">Forgot Password?</a><br>
            <a class="text-link" onclick="switchToSignUp()">Need an account? Sign up</a>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-storage-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAYFYeNmXN9HCouOfYFnI3ch20ynPXN62Q",
            authDomain: "lightning-ledgerz.firebaseapp.com",
            projectId: "lightning-ledgerz",
            storageBucket: "lightning-ledgerz.firebasestorage.app",
            messagingSenderId: "49377688541",
            appId: "1:49377688541:web:a2d77636b04134ca615434",
            measurementId: "G-R5G9397ZTX"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const storage = firebase.storage();

        // Modal functions
        function showSignUp(e) {
            e.preventDefault();
            document.getElementById('signup-modal').classList.remove('hidden');
        }

        function showSignIn(e) {
            e.preventDefault();
            document.getElementById('signin-modal').classList.remove('hidden');
        }

        function switchToSignIn() {
            document.getElementById('signup-modal').classList.add('hidden');
            document.getElementById('signin-modal').classList.remove('hidden');
        }

        function switchToSignUp() {
            document.getElementById('signin-modal').classList.add('hidden');
            document.getElementById('signup-modal').classList.remove('hidden');
        }

        window.addEventListener('click', (e) => {
            if (e.target.id === 'signup-modal') {
                document.getElementById('signup-modal').classList.add('hidden');
            }
            if (e.target.id === 'signin-modal') {
                document.getElementById('signin-modal').classList.add('hidden');
            }
        });

        // Sign Up
        document.getElementById("signup-form").addEventListener("submit", async (e) => {
            e.preventDefault();
            const firstName = document.getElementById("signup-firstname").value.trim();
            const lastName = document.getElementById("signup-lastname").value.trim();
            const email = document.getElementById("signup-email").value.trim();
            const password = document.getElementById("signup-password").value;

            try {
                const cred = await auth.createUserWithEmailAndPassword(email, password);
                
                await db.collection("users").doc(cred.user.uid).set({
                    firstName: firstName,
                    lastName: lastName,
                    email: email,
                    package: null,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });

                alert("Account created successfully! Welcome to Lightning Ledgerz.");
                document.getElementById("signup-modal").classList.add('hidden');
                
            } catch (error) {
                if (error.code === "auth/email-already-in-use") {
                    alert("This email is already registered. Please sign in instead.");
                } else if (error.code === "auth/weak-password") {
                    alert("Password should be at least 6 characters long.");
                } else {
                    alert("Signup failed: " + error.message);
                }
            }
        });

        // Sign In
        document.getElementById("signin-form").addEventListener("submit", async (e) => {
            e.preventDefault();
            const email = document.getElementById("signin-email").value.trim();
            const password = document.getElementById("signin-password").value;

            try {
                await auth.signInWithEmailAndPassword(email, password);
                alert("Welcome back!");
                document.getElementById("signin-modal").classList.add('hidden');
            } catch (error) {
                if (error.code === "auth/user-not-found") {
                    alert("No account found with this email. Please sign up first.");
                } else if (error.code === "auth/wrong-password") {
                    alert("Incorrect password. Please try again.");
                } else {
                    alert("Login failed: " + error.message);
                }
            }
        });

        // Forgot Password
        document.getElementById("forgot-password").addEventListener("click", async () => {
            const email = document.getElementById("signin-email").value.trim();

            if (!email) {
                alert("Please enter your email address first.");
                return;
            }

            try {
                await auth.sendPasswordResetEmail(email);
                alert("Password reset email sent! Check your inbox.");
            } catch (error) {
                alert("Failed to send reset email: " + error.message);
            }
        });

        // Auth State Observer
        auth.onAuthStateChanged(async (user) => {
            if (user) {
                const docSnap = await db.collection("users").doc(user.uid).get();
                const userData = docSnap.data();

                if (userData) {
                    const welcomeMsg = document.getElementById("welcomeMessage");
                    if (welcomeMsg) {
                        welcomeMsg.textContent = `Welcome, ${userData.firstName}!`;
                    }

                    const emailEl = document.getElementById("userEmail");
                    if (emailEl) {
                        emailEl.textContent = userData.email;
                    }

                    const planEl = document.getElementById("userPlan");
                    if (planEl) {
                        planEl.textContent = userData.package || "No package selected";
                    }

                    loadUserDocuments(user.uid);
                }
            } else {
                const welcomeMsg = document.getElementById("welcomeMessage");
                if (welcomeMsg) {
                    welcomeMsg.textContent = "";
                }
            }
        });

        // Upload Documents
        async function uploadDocuments() {
            const user = auth.currentUser;
            if (!user) {
                alert("Please log in first!");
                return;
            }

            const fileInput = document.getElementById("fileUpload");
            const files = fileInput.files;

            if (files.length === 0) {
                alert("Please select files to upload");
                return;
            }

            const progressDiv = document.getElementById("uploadProgress");
            const progressBar = document.getElementById("uploadBar");
            const statusText = document.getElementById("uploadStatus");
            progressDiv.style.display = "block";

            try {
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    statusText.textContent = `Uploading ${file.name}...`;
                    
                    const filePath = `users/${user.uid}/documents/${Date.now()}_${file.name}`;
                    const storageRef = storage.ref(filePath);
                    const uploadTask = storageRef.put(file);
                    
                    await new Promise((resolve, reject) => {
                        uploadTask.on('state_changed',
                            (snapshot) => {
                                const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                                progressBar.style.width = progress + '%';
                            },
                            (error) => reject(error),
                            async () => {
                                const downloadURL = await uploadTask.snapshot.ref.getDownloadURL();
                                
                                await db.collection("users").doc(user.uid).collection("documents").add({
                                    name: file.name,
                                    url: downloadURL,
                                    path: filePath,
                                    size: file.size,
                                    type: file.type,
                                    uploadedAt: firebase.firestore.FieldValue.serverTimestamp()
                                });
                                
                                resolve();
                            }
                        );
                    });
                }

                alert("All files uploaded successfully!");
                fileInput.value = "";
                progressDiv.style.display = "none";
                progressBar.style.width = "0%";
                statusText.textContent = "";
                
                loadUserDocuments(user.uid);

            } catch (error) {
                console.error("Upload error:", error);
                alert("Upload failed: " + error.message);
                progressDiv.style.display = "none";
            }
        }

        // Load User Documents
        async function loadUserDocuments(userId) {
            const docsList = document.getElementById("documentsList");
            if (!docsList) return;

            try {
                const snapshot = await db.collection("users").doc(userId).collection("documents")
                    .orderBy("uploadedAt", "desc")
                    .get();

                if (snapshot.empty) {
                    docsList.innerHTML = '<p style="color: #888;">No documents uploaded yet</p>';
                    return;
                }

                let html = '';
                
                snapshot.forEach((doc) => {
                    const data = doc.data();
                    const fileSize = (data.size / 1024).toFixed(2);
                    const date = data.uploadedAt ? data.uploadedAt.toDate().toLocaleDateString() : 'N/A';
                    
                    html += `
                        <div class="document-item">
                            <div>
                                <strong>${data.name}</strong>
                                <p>${fileSize} KB â€¢ ${date}</p>
                            </div>
                            <div class="document-actions">
                                <a href="${data.url}" target="_blank" class="btn btn-primary btn-small">View</a>
                                <button onclick="deleteDocument('${doc.id}')" class="btn btn-primary btn-small">Delete</button>
                            </div>
                        </div>
                    `;
                });
                
                docsList.innerHTML = html;

            } catch (error) {
                console.error("Error loading documents:", error);
                docsList.innerHTML = '<p style="color: red;">Error loading documents</p>';
            }
        }

        // Delete Document
        async function deleteDocument(docId) {
            const user = auth.currentUser;
            if (!user) return;

            if (!confirm("Are you sure you want to delete this document?")) {
                return;
            }

            try {
                const docRef = db.collection("users").doc(user.uid).collection("documents").doc(docId);
                const docSnap = await docRef.get();
                const data = docSnap.data();

                const storageRef = storage.ref(data.path);
                await storageRef.delete();

                await docRef.delete();

                alert("Document deleted successfully!");
                loadUserDocuments(user.uid);

            } catch (error) {
                console.error("Delete error:", error);
                alert("Failed to delete document: " + error.message);
            }
        }

        // Sign Out
        function signOutUser() {
            auth.signOut().then(() => {
                alert("Signed out successfully!");
                document.getElementById("profile").style.display = "none";
                window.location.href = "#top";
            });
        }

        // Handle My Profile Click
        function handleMyProfileClick(event) {
            event.preventDefault();
            const user = auth.currentUser;

            if (!user) {
                alert("Please sign in first.");
                showSignIn(event);
                return;
            }

            document.getElementById("profile").style.display = "block";
            document.getElementById("profile").scrollIntoView({ behavior: "smooth" });
        }

        // Scroll to Package
        function scrollToPackage(id) {
            const target = document.getElementById(id);
            if (target) {
                target.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Make functions globally available
        window.uploadDocuments = uploadDocuments;
        window.deleteDocument = deleteDocument;
        window.signOutUser = signOutUser;
        window.handleMyProfileClick = handleMyProfileClick;
        window.scrollToPackage = scrollToPackage;
        window.showSignUp = showSignUp;
        window.showSignIn = showSignIn;
        window.switchToSignIn = switchToSignIn;
        window.switchToSignUp = switchToSignUp;
    </script>
</body>
</html>
