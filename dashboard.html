<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lightning Ledgerz Dashboard</title>
    
    <!-- Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pptxgen@3.12.0/dist/pptxgen.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0f0f 0%, #1a1a2e 100%);
            color: #fff;
            overflow-x: hidden;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            padding: 20px;
            background: rgba(255, 51, 51, 0.1);
            border-left: 4px solid #ff3333;
            border-radius: 8px;
        }

        .welcome-text {
            font-size: 1.8rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .avatar-welcome {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            overflow: hidden;
            border: 3px solid #ff3333;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            border-bottom: 2px solid rgba(255, 51, 51, 0.2);
            padding-bottom: 10px;
        }

        .tab-button {
            padding: 12px 24px;
            background: transparent;
            color: #999;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .tab-button:hover {
            color: #ff3333;
        }

        .tab-button.active {
            color: #ff3333;
            border-bottom-color: #ff3333;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 51, 51, 0.3);
            border-radius: 12px;
            padding: 25px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .card:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: #ff3333;
            transform: translateY(-5px);
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 15px;
            color: #ff3333;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .metric-display {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 15px 0;
            color: #fff;
        }

        .metric-label {
            color: #999;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .upload-area {
            border: 2px dashed #ff3333;
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            background: rgba(255, 51, 51, 0.1);
        }

        .upload-area.dragover {
            background: rgba(255, 51, 51, 0.2);
            border-color: #ffff00;
        }

        input[type="file"] {
            display: none;
        }

        .btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #ff3333 0%, #cc0000 100%);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 51, 51, 0.3);
        }

        .btn.secondary {
            background: transparent;
            border: 2px solid #ff3333;
            color: #ff3333;
        }

        .status-message {
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            font-weight: 500;
        }

        .status-success {
            background: rgba(76, 175, 80, 0.2);
            color: #4caf50;
            border-left: 4px solid #4caf50;
        }

        .status-error {
            background: rgba(255, 82, 82, 0.2);
            color: #ff5252;
            border-left: 4px solid #ff5252;
        }

        .status-info {
            background: rgba(33, 150, 243, 0.2);
            color: #2196f3;
            border-left: 4px solid #2196f3;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
        }

        .presentation-section {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 51, 51, 0.3);
            border-radius: 12px;
            padding: 30px;
            margin: 20px 0;
        }

        .logo-preview {
            width: 150px;
            height: 150px;
            background: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 15px 0;
        }

        .logo-preview img {
            max-width: 100%;
            max-height: 100%;
        }

        .avatar-marketplace {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .avatar-item {
            background: rgba(255, 51, 51, 0.1);
            border: 2px solid rgba(255, 51, 51, 0.3);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .avatar-item:hover {
            border-color: #ff3333;
            background: rgba(255, 51, 51, 0.2);
        }

        .avatar-item-name {
            font-weight: bold;
            margin: 10px 0;
            color: #ff3333;
        }

        .avatar-item-price {
            font-size: 1.5rem;
            color: #ffd700;
            margin: 10px 0;
        }

        .rarity-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .rarity-common { background: #888; }
        .rarity-uncommon { background: #2caf50; }
        .rarity-rare { background: #2196f3; }
        .rarity-epic { background: #9c27b0; }
        .rarity-legendary { background: #ffb300; }

        .financial-synthesis {
            background: linear-gradient(135deg, rgba(255, 51, 51, 0.1) 0%, rgba(33, 150, 243, 0.1) 100%);
            border-left: 4px solid #ff3333;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            line-height: 1.8;
        }

        .synthesis-text {
            font-size: 1.1rem;
            color: #e0e0e0;
        }

        .synthesis-button {
            margin-top: 15px;
        }

        @media (max-width: 768px) {
            .dashboard-header {
                flex-direction: column;
                text-align: center;
            }

            .tabs {
                flex-direction: column;
            }

            .content-grid {
                grid-template-columns: 1fr;
            }

            .welcome-text {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <div class="dashboard-header">
            <div class="welcome-text">
                <div class="avatar-welcome" id="header-avatar"></div>
                <div>
                    <div id="welcome-message">Welcome to Lightning Ledgerz!</div>
                    <div style="font-size: 0.9rem; color: #999; margin-top: 5px;" id="user-level">Level 1</div>
                </div>
            </div>
            <div id="header-actions"></div>
        </div>

        <!-- Navigation Tabs -->
        <div class="tabs">
            <button class="tab-button active" onclick="switchTab(this, 'dashboard')">üìä Dashboard</button>
            <button class="tab-button" onclick="switchTab(this, 'presentations')">üìà Presentations</button>
            <button class="tab-button" onclick="switchTab(this, 'upload')">üìÅ Upload Files</button>
            <button class="tab-button" onclick="switchTab(this, 'avatar')">üé® Avatar</button>
            <button class="tab-button" onclick="switchTab(this, 'marketplace')">üõçÔ∏è Marketplace</button>
            <button class="tab-button" onclick="switchTab(this, 'referral')">üéÅ Share & Earn</button>
            <button class="tab-button" onclick="switchTab(this, 'settings')">‚öôÔ∏è Settings</button>
        </div>

        <!-- DASHBOARD TAB -->
        <div id="dashboard" class="tab-content active">
            <div class="content-grid">
                <div class="card">
                    <div class="card-title">Total Revenue</div>
                    <div class="metric-label">This Month</div>
                    <div class="metric-display" id="revenue-display">$0</div>
                </div>

                <div class="card">
                    <div class="card-title">Total Expenses</div>
                    <div class="metric-label">This Month</div>
                    <div class="metric-display" id="expenses-display">$0</div>
                </div>

                <div class="card">
                    <div class="card-title">Net Profit</div>
                    <div class="metric-label">This Month</div>
                    <div class="metric-display" id="profit-display">$0</div>
                </div>

                <div class="card">
                    <div class="card-title">Cash Flow</div>
                    <div class="metric-label">Available</div>
                    <div class="metric-display" id="cashflow-display">$0</div>
                </div>
            </div>

            <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 51, 51, 0.3); border-radius: 12px; padding: 30px; margin-top: 30px;">
                <h3 style="color: #ff3333; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 1px;">Financial Overview</h3>
                <div class="chart-container">
                    <canvas id="overview-chart"></canvas>
                </div>
            </div>

            <div id="financial-insights" class="financial-synthesis" style="display: none;">
                <h4 style="color: #ff3333; margin-bottom: 15px;">AI Financial Insights ü§ñ</h4>
                <div class="synthesis-text" id="insights-text"></div>
                <button class="btn synthesis-button" onclick="generateFinancialInsights()">üîä Generate Verbal Analysis</button>
            </div>
        </div>

        <!-- PRESENTATIONS TAB -->
        <div id="presentations" class="tab-content">
            <div class="presentation-section">
                <h3 style="color: #ff3333; margin-bottom: 20px; text-transform: uppercase;">Create Presentation</h3>
                
                <div style="margin: 30px 0;">
                    <label style="display: block; margin-bottom: 10px; color: #ff3333; font-weight: bold;">Company Logo</label>
                    <div class="upload-area" onclick="document.getElementById('logo-upload').click()" style="margin-bottom: 15px;">
                        <div style="font-size: 2rem; margin-bottom: 10px;">üì∏</div>
                        <div>Click to upload your company logo</div>
                    </div>
                    <input type="file" id="logo-upload" accept="image/*">
                    <div class="logo-preview" id="logo-preview" style="display: none;"></div>
                    <div id="logo-status"></div>
                </div>

                <div style="margin: 30px 0;">
                    <label style="display: block; margin-bottom: 10px; color: #ff3333; font-weight: bold;">Presentation Template</label>
                    <select id="template-select" style="width: 100%; padding: 12px; border: 1px solid #ff3333; border-radius: 6px; background: #1a1a1a; color: #fff; margin-bottom: 20px;">
                        <option value="financial_summary">Financial Summary</option>
                        <option value="budget_breakdown">Budget Breakdown</option>
                        <option value="trends_analysis">Trends Analysis</option>
                        <option value="comparison">Year-over-Year Comparison</option>
                        <option value="forecast">Financial Forecast</option>
                    </select>
                </div>

                <button class="btn" onclick="createPresentation()">Create Presentation</button>
            </div>

            <div id="presentation-preview" style="display: none; margin-top: 30px;">
                <div id="presentation-container"></div>
            </div>
        </div>

        <!-- FILE UPLOAD TAB -->
        <div id="upload" class="tab-content">
            <div class="card">
                <h3 class="card-title">Upload Financial Documents</h3>
                <p style="color: #999; margin-bottom: 20px;">Upload PDF invoices, Excel spreadsheets, or CSV files to analyze your financial data</p>

                <div class="upload-area" id="main-upload-area" ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)" onclick="document.getElementById('file-upload').click()">
                    <div style="font-size: 3rem; margin-bottom: 10px;">üìÅ</div>
                    <div style="font-size: 1.1rem; margin-bottom: 5px;">Drag & drop files here or click to browse</div>
                    <div style="color: #999; font-size: 0.9rem;">Supported formats: PDF, Excel (.xlsx, .xls), CSV</div>
                </div>
                <input type="file" id="file-upload" multiple accept=".pdf,.xlsx,.xls,.csv">
                <div id="upload-status" style="margin-top: 20px;"></div>

                <div id="uploaded-files" style="margin-top: 30px;"></div>
            </div>

            <div id="extracted-data" style="display: none; margin-top: 30px;"></div>
        </div>

        <!-- AVATAR TAB -->
        <div id="avatar" class="tab-content">
            <div class="content-grid">
                <div class="card" style="grid-column: 1 / -1;">
                    <h3 class="card-title">Customize Your Avatar</h3>
                    <div id="avatar-preview" style="text-align: center; margin: 30px 0;"></div>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 30px 0;">
                        <div>
                            <label style="display: block; margin-bottom: 8px; color: #ff3333; font-weight: bold;">Gender</label>
                            <select id="avatar-gender" onchange="updateAvatarPreview()" style="width: 100%; padding: 8px; border: 1px solid #ff3333; border-radius: 4px; background: #1a1a1a; color: #fff;">
                                <option>Male</option>
                                <option>Female</option>
                                <option>Non-binary</option>
                            </select>
                        </div>

                        <div>
                            <label style="display: block; margin-bottom: 8px; color: #ff3333; font-weight: bold;">Skin Tone</label>
                            <select id="avatar-skin" onchange="updateAvatarPreview()" style="width: 100%; padding: 8px; border: 1px solid #ff3333; border-radius: 4px; background: #1a1a1a; color: #fff;">
                                <option>Light</option>
                                <option>Medium Light</option>
                                <option>Medium</option>
                                <option>Medium Dark</option>
                                <option>Dark</option>
                            </select>
                        </div>

                        <div>
                            <label style="display: block; margin-bottom: 8px; color: #ff3333; font-weight: bold;">Eye Color</label>
                            <select id="avatar-eyes" onchange="updateAvatarPreview()" style="width: 100%; padding: 8px; border: 1px solid #ff3333; border-radius: 4px; background: #1a1a1a; color: #fff;">
                                <option>Blue</option>
                                <option>Brown</option>
                                <option>Green</option>
                                <option>Hazel</option>
                                <option>Gray</option>
                            </select>
                        </div>

                        <div>
                            <label style="display: block; margin-bottom: 8px; color: #ff3333; font-weight: bold;">Hair Style</label>
                            <select id="avatar-hair-style" onchange="updateAvatarPreview()" style="width: 100%; padding: 8px; border: 1px solid #ff3333; border-radius: 4px; background: #1a1a1a; color: #fff;">
                                <option>Short</option>
                                <option>Medium</option>
                                <option>Long</option>
                                <option>Bald</option>
                                <option>Curly</option>
                                <option>Afro</option>
                            </select>
                        </div>

                        <div>
                            <label style="display: block; margin-bottom: 8px; color: #ff3333; font-weight: bold;">Hair Color</label>
                            <select id="avatar-hair-color" onchange="updateAvatarPreview()" style="width: 100%; padding: 8px; border: 1px solid #ff3333; border-radius: 4px; background: #1a1a1a; color: #fff;">
                                <option>Black</option>
                                <option>Brown</option>
                                <option>Blonde</option>
                                <option>Red</option>
                                <option>Gray</option>
                            </select>
                        </div>

                        <div>
                            <label style="display: block; margin-bottom: 8px; color: #ff3333; font-weight: bold;">Outfit</label>
                            <select id="avatar-outfit" onchange="updateAvatarPreview()" style="width: 100%; padding: 8px; border: 1px solid #ff3333; border-radius: 4px; background: #1a1a1a; color: #fff;">
                                <option>Business Suit</option>
                                <option>Blazer</option>
                                <option>Casual</option>
                                <option>Dress Professional</option>
                                <option>Formal</option>
                            </select>
                        </div>
                    </div>

                    <button class="btn" onclick="saveAvatarCustomization()" style="margin-top: 20px;">Save Avatar</button>
                </div>
            </div>

            <div class="card" style="margin-top: 30px;">
                <h3 class="card-title">Avatar Animations</h3>
                <p style="color: #999; margin-bottom: 20px;">Click buttons to see your avatar in action!</p>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn secondary" onclick="playAvatarAnimation('waving')">üëã Wave</button>
                    <button class="btn secondary" onclick="playAvatarAnimation('thumbsUp')">üëç Thumbs Up</button>
                    <button class="btn secondary" onclick="playAvatarAnimation('celebrating')">üéâ Celebrate</button>
                    <button class="btn secondary" onclick="playAvatarAnimation('analyzing')">ü§î Analyze</button>
                    <button class="btn secondary" onclick="playAvatarAnimation('happy')">üòä Smile</button>
                </div>
            </div>
        </div>

        <!-- MARKETPLACE TAB -->
        <div id="marketplace" class="tab-content">
            <div class="card" style="margin-bottom: 30px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <div class="card-title">Your Inventory</div>
                        <div style="color: #999;">Lightning Credits: <span style="color: #ffd700; font-weight: bold;" id="credits-display">0</span></div>
                        <div style="color: #999;">Level: <span style="color: #ff3333; font-weight: bold;" id="level-display">1</span></div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 2rem; margin-bottom: 10px;">üìä</div>
                        <button class="btn secondary" onclick="earnMoreCredits()">Earn More Credits</button>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-bottom: 30px;">
                <h3 class="card-title">Featured Items</h3>
                <div class="avatar-marketplace" id="marketplace-items"></div>
            </div>
        </div>

        <!-- REFERRAL TAB -->
        <div id="referral" class="tab-content">
            <div id="referral-widget-container"></div>

            <div class="card" style="margin-top: 30px;">
                <h3 class="card-title">Your Referrals</h3>
                <div id="referral-stats" style="margin: 20px 0;">
                    <div class="content-grid">
                        <div class="card">
                            <div class="card-title">People Referred</div>
                            <div class="metric-display" id="referral-count">0</div>
                        </div>
                        <div class="card">
                            <div class="card-title">Rewards Earned</div>
                            <div class="metric-display" id="reward-count">0 months</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SETTINGS TAB -->
        <div id="settings" class="tab-content">
            <div class="card">
                <h3 class="card-title">Account Settings</h3>
                
                <div style="margin: 20px 0;">
                    <label style="display: block; margin-bottom: 8px; color: #ff3333; font-weight: bold;">Email</label>
                    <input type="email" id="settings-email" readonly style="width: 100%; padding: 12px; border: 1px solid #999; border-radius: 6px; background: #1a1a1a; color: #fff;">
                </div>

                <div style="margin: 20px 0;">
                    <label style="display: block; margin-bottom: 8px; color: #ff3333; font-weight: bold;">Username</label>
                    <input type="text" id="settings-username" style="width: 100%; padding: 12px; border: 1px solid #ff3333; border-radius: 6px; background: #1a1a1a; color: #fff;">
                </div>

                <button class="btn" onclick="updateSettings()">Save Settings</button>
            </div>

            <div class="card" style="margin-top: 30px;">
                <h3 class="card-title">Password</h3>
                <div style="margin: 20px 0;">
                    <label style="display: block; margin-bottom: 8px; color: #ff3333; font-weight: bold;">New Password</label>
                    <input type="password" id="new-password" placeholder="Enter new password" style="width: 100%; padding: 12px; border: 1px solid #ff3333; border-radius: 6px; background: #1a1a1a; color: #fff;">
                </div>

                <div style="margin: 20px 0;">
                    <label style="display: block; margin-bottom: 8px; color: #ff3333; font-weight: bold;">Confirm Password</label>
                    <input type="password" id="confirm-password" placeholder="Confirm password" style="width: 100%; padding: 12px; border: 1px solid #ff3333; border-radius: 6px; background: #1a1a1a; color: #fff;">
                </div>

                <button class="btn" onclick="changePassword()">Update Password</button>
            </div>

            <div class="card" style="margin-top: 30px;">
                <h3 class="card-title">Danger Zone</h3>
                <button class="btn secondary" style="background: transparent; border: 2px solid #ff5252; color: #ff5252;" onclick="logout()">Logout</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="app.js"></script>
    <script src="presentation-builder.js"></script>
    <script src="data-synthesizer.js"></script>
    <script src="avatar-system-enhanced.js"></script>
    <script src="ai-financial-analyst.js"></script>
    <script src="referral-system.js"></script>

    <script>
        // Tab switching
        function switchTab(button, tabName) {
            // Remove active class from all buttons and tabs
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));

            // Add active class to clicked button and corresponding tab
            button.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // File upload handlers
        function handleDragOver(e) {
            e.preventDefault();
            document.getElementById('main-upload-area').classList.add('dragover');
        }

        function handleDragLeave(e) {
            document.getElementById('main-upload-area').classList.remove('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            document.getElementById('main-upload-area').classList.remove('dragover');
            const files = e.dataTransfer.files;
            document.getElementById('file-upload').files = files;
            handleFileUpload({ target: { files } });
        }

        // File upload
        document.addEventListener('DOMContentLoaded', function() {
            setupFileUploadHandler();
            loadMarketplaceItems();
            initializeDashboard();
        });

        function handleFileUpload(e) {
            const file = e.target.files[0];
            if (file) {
                dataSynthesizer.handleFileUpload(file).then(result => {
                    console.log('File processed:', result);
                    document.getElementById('upload-status').innerHTML = '<div class="status-message status-success">‚úì File processed successfully!</div>';
                }).catch(error => {
                    document.getElementById('upload-status').innerHTML = `<div class="status-message status-error">‚úó Error: ${error.message}</div>`;
                });
            }
        }

        // Avatar functions
        function updateAvatarPreview() {
            const avatarData = {
                gender: document.getElementById('avatar-gender').value.toLowerCase(),
                skinTone: document.getElementById('avatar-skin').value.toLowerCase().replace(' ', '-'),
                eyeColor: document.getElementById('avatar-eyes').value.toLowerCase(),
                hairStyle: document.getElementById('avatar-hair-style').value.toLowerCase(),
                hairColor: document.getElementById('avatar-hair-color').value.toLowerCase(),
                outfit: 'business-suit',
                outfitColor: 'navy',
                size: 'large'
            };

            const preview = document.getElementById('avatar-preview');
            preview.innerHTML = avatarSystem.createAvatarElement(avatarData);
        }

        function playAvatarAnimation(animationType) {
            const svg = document.querySelector('#avatar-preview .avatar-svg');
            if (svg) {
                avatarSystem.playAnimation(svg, animationType, 1500);
            }
        }

        function saveAvatarCustomization() {
            if (currentUser) {
                alert('Avatar saved! üéâ');
            } else {
                alert('Please login to save your avatar.');
            }
        }

        // Logo upload
        document.addEventListener('DOMContentLoaded', function() {
            const logoInput = document.getElementById('logo-upload');
            if (logoInput) {
                logoInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            const preview = document.getElementById('logo-preview');
                            preview.style.display = 'flex';
                            preview.innerHTML = `<img src="${event.target.result}" alt="Logo">`;
                            document.getElementById('logo-status').innerHTML = '<div class="status-message status-success">‚úì Logo uploaded!</div>';
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
        });

        // Presentation creation
        function createPresentation() {
            const template = document.getElementById('template-select').value;
            alert(`Creating ${template} presentation...`);
            // Add presentation logic here
        }

        // Financial insights
        function generateFinancialInsights() {
            const data = {
                revenue: 50000,
                expenses: 30000,
                profit: 20000,
                cashFlow: 15000
            };
            aiAnalyst.synthesizeFinancialTrends(data, true);
        }

        // Dashboard initialization
        function initializeDashboard() {
            updateAvatarPreview();
            loadMarketplaceItems();
        }

        // Marketplace items
        function loadMarketplaceItems() {
            const items = [
                avatarSystem.createMarketplaceItem('outfit', 'CEO Suit', 500, 'üé©'),
                avatarSystem.createMarketplaceItem('outfit', 'Casual Blazer', 300, 'üß•'),
                avatarSystem.createMarketplaceItem('accessory', 'Gold Watch', 200, '‚åö'),
                avatarSystem.createMarketplaceItem('background', 'Office View', 400, 'üè¢'),
                avatarSystem.createMarketplaceItem('animation', 'Power Pose', 600, 'üí™'),
                avatarSystem.createMarketplaceItem('outfit', 'Summer Outfit', 250, 'üëï')
            ];

            const container = document.getElementById('marketplace-items');
            container.innerHTML = items.map(item => `
                <div class="avatar-item">
                    <div style="font-size: 3rem; margin-bottom: 10px;">${item.preview}</div>
                    <div class="avatar-item-name">${item.name}</div>
                    <div class="rarity-badge rarity-${item.rarity}">${item.rarity}</div>
                    <div class="avatar-item-price">${item.price} ‚ö°</div>
                    <button class="btn" style="width: 100%; margin-top: 10px; padding: 8px;">Buy Now</button>
                </div>
            `).join('');
        }

        // Settings
        function updateSettings() {
            alert('Settings updated!');
        }

        function changePassword() {
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;

            if (newPassword !== confirmPassword) {
                alert('Passwords do not match!');
                return;
            }

            if (newPassword.length < 6) {
                alert('Password must be at least 6 characters long!');
                return;
            }

            alert('Password changed successfully!');
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                supabase.auth.signOut();
                window.location.href = 'index.html';
            }
        }

        function earnMoreCredits() {
            alert('Complete tasks to earn more credits! üéØ');
        }
    </script>
</body>
</html>
